---
layout: default
title: snippets/perl/dperl.pl
---

<h2>dperl.pl - Helps maintaining your perl project</h2>

<h3>Description</h3>
<p>
    <code>dperl</code> is a result of <acronym title="jhthorsen@cpan.org">me</acronym>
    getting tired of doing the same stuff - or rather forgetting to do the same stuff for
    each of my perl projects. dperl does <i>not</i> feature the same things
    as <a href="http://search.cpan.org/dist/Dist-Zilla">Dist::Zilla</a>, but
    I would like to think of dperl VS dzil as <a href="http://search.cpan.org/dist/CPAN">CPAN</a>
    vs <a href="http://search.cpan.org/dist/App-cpanminus">cpanm</a> - or at
    least that is what I'm aming for. (!) What I don't want to do, is to configure
    anything, so 1) it just works 2) it might not work as
    <a href="http://flodhest.net/contact">you want it to</a>.
</p>
<p>
    <code>dperl.pl</code> can be tested by running one of the lines below
    in your favourite <a href="http://en.wikipedia.org/wiki/Terminal_emulator">terminal</a>:
</p>
<pre>
# stable
$ wget -q http://bit.ly/dperl -O - | perl -
$ wget -q http://jhthorsen.github.com/snippets/dperl/run -O - | perl -

# experimental
$ wget -q http://github.com/jhthorsen/snippets/raw/master/perl/dperl.pl -O - | perl -
</pre>

<h3>Features</h3>
<ul>
    <li>
        Generates <a href="http://search.cpan.org/dist/Module-Install">Module::Install</a> styled Makefile.PL
        (..and no - you cannot choose any other) from guesswork and black magic
    </li>
    <li>
        Will insert release date in Changes file, at the first line containing
        a proper formatted version number, and nothing more. Meaning:
        <code>\d+\.[0-9_]+</code>.
    </li>
    <li>Generates compile tests and pod tests</li>
    <li>Generates MANIFEST and MANIFEST.SKIP</li>
    <li>Generates README from top level module</li>
    <li>
        Update VERSION in top module:
        <br><code>s/=head1 VERSION.*?\n=/=head1 VERSION\n\n$VERSION\n\n=/s</code>
        <br><code>s/\$VERSION\s*=.*$/\$VERSION = '$VERSION';/m;</code>
    </li>
    <li>
        Create a dist, without weird files present. (because of generated MANIFEST.SKIP)
        <br>TODO: upload dist to CPAN and github.
    </li>
    <li>Commit and tag the release and pushes the changes to "origin"</li>
    <li>Build and test the project</li>
    <li>Can properly clean up <i>all</i> build files</li>
</ul>

<h3>Synopsis</h3>
<pre>
Usage dperl.pl [option]

 -update
  * Update version information in main module
  * Create/update t/00-load.t and t/99-pod*t
  * Create/update README

 -build
  * Same as -update
  * Update Changes with release date
  * Create MANIFEST* and META.yml
  * Tag and commit the changes (locally)
  * Build a distribution (.tar.gz)

 -share (experimental)
  * Push commit and tag to "origin"
  * Upload the disted file to CPAN

 -test
  * Create/update t/00-load.t and t/99-pod*t
  * Test the project

 -clean
  * Remove files and directories which should not be included
    in the project repo

 -makefile
  * Create a Makefile.PL from plain guesswork

 -man
  * Display manual for dperl.pl
</pre>

<h3>Requirements</h3>
<p>
    You need to structure your project like this for dperl.pl to work:
</p>
<pre>
my-perl-project/
my-perl-project/lib/
my-perl-project/lib/My/
my-perl-project/lib/My/Perl
my-perl-project/lib/My/Perl/Project.pm
</pre>
<p>
    Meaning the project directory must be called the same as the top module
    in your repository. LowEr/uPperCaSE does not matter.
</p>
<ul>
    <li>Perl 5.10.x</li>
    <li>Cwd</li>
    <li>File::Basename</li>
    <li>File::Find</li>
    <li>YAML::Tiny - not in core, but required by CPAN/CPANPLUS</li>
</ul>

<h3>Resources</h3>
<ul>
    <li><a href="http://github.com/jhthorsen/snippets/blob/master/perl/dperl.pl">Source code</a></li>
    <li><a href="http://github.com/jhthorsen/snippets/issues">Issues</a></li>
</ul>

<h3>License</h3>
<p>
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.
</p>
<p>
    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
</p>
<p>
    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.
</p>
<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_identifier = 'dperl';
  (function() {
   var dsq = document.createElement('script');
   dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = 'http://jhthorsen-github.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=jhthorsen-github">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
